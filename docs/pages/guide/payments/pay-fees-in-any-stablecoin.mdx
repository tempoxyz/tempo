---
showOutline: 1
---

import * as Demo from '../../../components/guides/Demo.tsx'
import * as Step from '../../../components/guides/steps'
import { betaUsd, thetaUsd, pathUsd } from '../../../components/guides/tokens.ts'
import LucideCoins from '~icons/lucide/coins'
import * as Card from '../../../components/Card.tsx'
import { Tabs } from '../../../components/Tabs.tsx'

# Pay Fees in Any Stablecoin

Configure users to pay transaction fees in any supported stablecoin. Tempo's flexible fee system allows users to pay fees with the same token they're using, eliminating the need to hold a separate gas token.

## Demo

By the end of this guide you will be able to pay fees in any stablecoin on Tempo.

<Demo.Container name="Pay Fees in Any Stablecoin" footerVariant="source" src="tempoxyz/tempo-ts/tree/main/examples/payments">
  <Step.Connect stepNumber={1} />
  <Step.AddFunds stepNumber={2} />
  <Step.PayWithFeeToken stepNumber={3} feeToken={betaUsd} last />
</Demo.Container>

## Quick Snippet

Using a custom fee token is as simple as passing a `feeToken` attribute to mutable actions like `useTransferSync`, `useSendTransactionSync`, and more.

<Tabs className="-mt-2">
  <Tabs.Tab value="Wagmi">

<div className="h-6" />

```tsx twoslash
// @noErrors
import { Hooks } from 'wagmi/tempo'
import { parseUnits } from 'viem'

const DONOTUSE = '0x20c000000000000000000000033abb6ac7d235e5'
const betaUsd = '0x20c0000000000000000000000000000000000002'

const sendPayment = Hooks.token.useTransferSync()

sendPayment.mutate({ 
  amount: parseUnits('100', 6), 
  feeToken: betaUsd, // [!code ++]
  to: '0x0000000000000000000000000000000000000000', 
  token: DONOTUSE, 
}) 
```

</Tabs.Tab>
<Tabs.Tab value="Viem">

<div className="h-6" />

```tsx twoslash
// @noErrors
import { parseUnits } from 'viem'
import { client } from './viem.config'

const DONOTUSE = '0x20c000000000000000000000033abb6ac7d235e5'
const betaUsd = '0x20c0000000000000000000000000000000000002'

const receipt = await client.token.transferSync({ 
  amount: parseUnits('100', 6), 
  feeToken: betaUsd, // [!code ++]
  to: '0x0000000000000000000000000000000000000000', 
  token: DONOTUSE, 
}) 
```

</Tabs.Tab>
</Tabs>

## Steps

<Tabs>
  <Tabs.Tab value="Wagmi">
::::steps

### Set up Wagmi & integrate accounts

Ensure that you have set up your project with Wagmi and integrated accounts by following either of the guides:

- [Embed Passkey accounts](/guide/use-accounts/embed-passkeys)
- [Connect to wallets](/guide/use-accounts/connect-to-wallets)

### Add funds¹

Before you can pay fees in a token of your choice, you need to fund your account. In this guide you will be sending `DONOTUSE` (`0x20c000…33abb6ac7d235e5`) and paying fees in `BetaUSD` (`0x20c000…0002`).

The built-in Tempo mainnet candidate faucet includes `DONOTUSE` when funding.

<Demo.Container name="Add Funds" footerVariant="balances" showBadge={false} tokens={[Demo.DONOTUSE, Demo.betaUsd, Demo.thetaUsd, Demo.pathUsd]}>
  <Step.AddFunds stepNumber={1} last />
</Demo.Container>

:::code-group

```tsx twoslash [AddFunds.ts]
// @noErrors
import { Hooks } from 'wagmi/tempo'
import { useConnection } from 'wagmi'

function AddFunds() {
  const { address } = useConnection()
  const { mutate, isPending } = Hooks.faucet.useFundSync()

  return (
    <button onClick={() => mutate({ account: address })} disabled={isPending}>
      Add Funds
    </button>
  )
}
```

```tsx twoslash [wagmi.config.ts] filename="wagmi.config.ts"
// @noErrors
// [!include ~/snippets/wagmi.config.ts:setup]
```

:::

:::warning
¹ It is important to note that the `addFunds` Hook only works on testnets as a convenience feature to get
started quickly. For production, you will need to onramp & fund your account manually.
:::

### Add pay with fee token logic

Now that you have `DONOTUSE` to send and `BetaUSD` to pay fees with, you can add a form that allows users to select a fee token and send a payment.

After this step, your users can send payments with a specified fee token by clicking the "Send Payment" button!

<Demo.Container name="Pay Fees in Any Stablecoin" footerVariant="source" src="tempoxyz/tempo-ts/tree/main/examples/payments">
  <Step.AddFunds stepNumber={1} />
  <Step.PayWithFeeToken stepNumber={2} last />
</Demo.Container>

:::code-group

```tsx twoslash [PayWithFeeToken.tsx]
import { Hooks } from 'wagmi/tempo'
import { parseUnits } from 'viem'

const DONOTUSE = '0x20c000000000000000000000033abb6ac7d235e5'
const betaUsd = '0x20c0000000000000000000000000000000000002'
const thetaUsd = '0x20c0000000000000000000000000000000000003'
const pathUsd = '0x20c0000000000000000000000000000000000000'

// @noErrors
function PayWithFeeToken() {
  const sendPayment = Hooks.token.useTransferSync()
  const metadata = Hooks.token.useGetMetadata({
    token: DONOTUSE,
  })

  return (
    <form onSubmit={
      (event) => {
        event.preventDefault()
        const formData = new FormData(event.target as HTMLFormElement)

        const recipient = (formData.get('recipient') ||
          '0x0000000000000000000000000000000000000000') as `0x${string}`
        const feeToken = (formData.get('feeToken') ||
          DONOTUSE) as `0x${string}`

        sendPayment.mutate({ // [!code hl]
          amount: parseUnits('100', metadata.data?.decimals ?? 6), // [!code hl]
          to: recipient, // [!code hl]
          token: DONOTUSE, // [!code hl]
          feeToken: feeToken, // [!code hl]
        }) // [!code hl]
      }
    }>
      <div>
        <label htmlFor="recipient">Recipient address</label>
        <input type="text" name="recipient" placeholder="0x..." />
      </div>
      <div>
        <label htmlFor="feeToken">Fee token</label>
        <select name="feeToken">
          <option value={DONOTUSE}>DONOTUSE</option>
          <option value={betaUsd}>BetaUSD</option>
          <option value={thetaUsd}>ThetaUSD</option>
          <option value={pathUsd}>pathUSD</option>
        </select>
      </div>
      <button type="submit" disabled={sendPayment.isPending}>
        Send Payment
      </button>
    </form>
  )
}
```

```tsx twoslash [wagmi.config.ts] filename="wagmi.config.ts"
// @noErrors
// [!include ~/snippets/wagmi.config.ts:setup]
```
:::

### Display a receipt

Now that users can send payments with a specified fee token, you can link to the transaction receipt.

:::code-group

```tsx twoslash [PayWithFeeToken.tsx]
import { Hooks } from 'wagmi/tempo'
import { parseUnits } from 'viem'

const DONOTUSE = '0x20c000000000000000000000033abb6ac7d235e5'
const betaUsd = '0x20c0000000000000000000000000000000000002'
const thetaUsd = '0x20c0000000000000000000000000000000000003'
const pathUsd = '0x20c0000000000000000000000000000000000000'

// @noErrors
function PayWithFeeToken() {
  const sendPayment = Hooks.token.useTransferSync()
  const metadata = Hooks.token.useGetMetadata({
    token: DONOTUSE,
  })

  return (
    <>
      {/* ... your payment form ... */}
      {sendPayment.data && ( // [!code ++]
        <a href={`https://explore.tempo.xyz/tx/${sendPayment.data.receipt.transactionHash}`}> {/* // [!code ++] */}
          View receipt {/* // [!code ++] */}
        </a> // [!code ++]
      )} // [!code ++]
    </>
  )
}
```

```tsx twoslash [wagmi.config.ts] filename="wagmi.config.ts"
// @noErrors
// [!include ~/snippets/wagmi.config.ts:setup]
```
:::

### Next steps

Now that you have made a payment using a desired fee token, you can:
- Follow a guide on how to [sponsor user fees](/guide/payments/sponsor-user-fees) to enable gasless transactions
- Learn more about [transaction fees](/protocol/fees)

::::

  </Tabs.Tab>
  <Tabs.Tab value="Viem">

::::steps

### Set up Viem Client

First, we will set up a Viem client configured with Tempo.

```ts twoslash [viem.config.ts]
// [!include ~/snippets/viem.config.ts:setup]
```

:::info

For simplicity of the guide, this example uses a Private Key (Secp256k1) account instead of Passkeys (WebAuthn).

:::

### Add testnet funds¹

Before you can pay fees in a token of your choice, you need to fund your account. In this guide you will be sending `DONOTUSE` (`0x20c000…0001`) and paying fees in `BetaUSD` (`0x20c000…0002`).

The built-in Tempo testnet faucet includes `DONOTUSE` and `BetaUSD` when funding.

<Demo.Container name="Add Funds" footerVariant="balances" showBadge={false} tokens={[Demo.DONOTUSE, Demo.betaUsd, Demo.thetaUsd, Demo.pathUsd]}>
  <Step.AddFunds stepNumber={1} last />
</Demo.Container>

:::code-group

```tsx twoslash [example.ts]
// @noErrors
import { client } from './viem.config'

await client.faucet.fundSync({
  account: client.account,
})
```

```tsx twoslash [viem.config.ts] filename="viem.config.ts"
// @noErrors
// [!include ~/snippets/viem.config.ts:setup]
```

:::

### Add pay with fee token logic

Now that you have `DONOTUSE` to send and `BetaUSD` to pay fees with, you can now add logic to send a payment with a specified fee token.

<Demo.Container name="Pay Fees in Any Stablecoin" footerVariant="source" src="tempoxyz/tempo-ts/tree/main/examples/payments">
  <Step.AddFunds stepNumber={1} />
  <Step.PayWithFeeToken stepNumber={2} last />
</Demo.Container>

:::code-group

```tsx twoslash [example.ts]
// @noErrors
import { client } from './viem.config'

const receipt = await client.token.transferSync({
  amount: parseUnits('100', 6),
  feeToken: betaUsd, // [!code hl]
  to: '0x0000000000000000000000000000000000000000',
  token: DONOTUSE,
})
```

```tsx twoslash [viem.config.ts] filename="viem.config.ts"
// @noErrors
// [!include ~/snippets/viem.config.ts:setup]
```

:::

::::

  </Tabs.Tab>
</Tabs>

# Recipes

## Set user fee token 

You can also set a persistent default fee token for an account, so users don't need to specify `feeToken` on every transaction. Learn more about fee token preferences [here](/protocol/fees/spec-fee#fee-token-preferences).

<Tabs className="-mt-2">
<Tabs.Tab value="Wagmi">

<div className="h-6" />

```tsx twoslash
// @noErrors
// [!include ~/snippets/unformatted/fee.setUserToken.ts:wagmi-hooks]
```

</Tabs.Tab>
<Tabs.Tab value="Viem">

<div className="h-6" />

```ts twoslash
// @noErrors
// [!include ~/snippets/unformatted/fee.setUserToken.ts:viem]
```

</Tabs.Tab>
</Tabs>

## Learning Resources

<Card.Container>
  <Card.Link
    description="Learn more about transaction fees on Tempo"
    href="/protocol/fees"
    icon={LucideCoins}
    title="Transaction Fees"
  />
</Card.Container>
